// Hi Emacs, this is -*- mode: c++; tab-width: 6; indent-tabs-mode: nil; c-basic-offset: 6 -*-
#include "spectrum_mask.h"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
SpectrumMask::SpectrumMask(int sampling_rate, int fft_size) {

      fs   = sampling_rate;
      size = fft_size;
      value = new double[size];

      int i;
      for (i = 0; i < size; i++) {
            value[i] = 0.0; // dB
      }

      // Máscara rectangular simple
      // Estimación de la SNRI considerando la banda (af1, af2) = (900, 1100) Hz
      double analog_resolution = (double) sampling_rate / (double) fft_size; 
      int d1 = (int) floor( 900 / analog_resolution);
      int d2 = (int) ceil (1100 / analog_resolution);

      for (i = 0; i < size; i++) {
            value[i] = -8.0; // dB
      }     
      for (i = d1; i < d2; i++) {
            value[i] = +3.0; // dB
      }

      error_count = 0;

      first_trespassing_frequency = nan("");
      first_trespassing_value = nan("");
      last_trespassing_frequency = nan("");
      last_trespassing_value = nan("");
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
SpectrumMask::~SpectrumMask() {
      delete[] value;
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
